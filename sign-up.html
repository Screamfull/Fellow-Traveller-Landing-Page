<!DOCTYPE html>
<html lang="el-GR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up | Fellow Traveller</title>
  <link rel="stylesheet" href="resources/css/sign-up.css">
  <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,500,600&display=swap" rel="stylesheet"> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
  
  <section>
    <div id="heading">
      <h1><strong>Lorem ipsum</strong></h1>
      <p>Lorem ipsum dolor sit amet</p>
    </div>
    <form>
      <label for="email">Email</label>
      <input type="email" name="email" placeholder="example@email.com" maxlength="50" required>
      <input type="submit" value="Sign up">
    </form>
    <div id="success">
      <span>Success message!</span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="11"/>
        <polyline points="19.37 7.14 9.65 16.86 4.63 11.84"/>
      </svg>
    </div>
    <div id="invalid">
      <span>Invalid email!</span>
      <svg dxmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="11"/>
        <line x1="6.65" y1="6.65" x2="17.35" y2="17.35"/>
        <line x1="6.65" y1="17.35" x2="17.35" y2="6.65"/>
      </svg>
    </div>
    <div id="exists">
      <span>Already exists!</span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="11"/>
        <path d="M12,6.87A5.13,5.13,0,1,0,17.13,12V9.76" transform="translate(0 0)"/>
        <polyline points="14.89 12 17.13 9.76 19.37 12"/>
      </svg>
    </div>
    <div id="error">
      <span>Oops, an error occured!</span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <line x1="12" y1="5.76" x2="12" y2="15.15"/>
        <line x1="12" y1="17.08" x2="12" y2="18.24"/>
        <polygon points="16.4 1.38 7.6 1.38 1.38 7.6 1.38 16.4 7.6 22.62 16.4 22.62 22.62 16.4 22.62 7.6 16.4 1.38"/>
      </svg>
    </div>
    <a href="index.html">Go Back</a>
  </section>

  <script>
    $(document).ready(function(){
      $("form").submit(function(){
        event.preventDefault();

        var email = '"email":"'.concat($('input[type=email]').val()).concat('"');
        alert(email);

        $.ajax({
          type: "post",
          url: "http://snf-874026.vm.okeanos.grnet.gr:5025/newsletter",
          data: email
        }).done(function(response) {
          var code = response;
        });
        
        $('form').fadeOut(200);
        $("#heading").fadeOut(200);

        switch (code) {
          case 201:
            $('#success').delay(200).fadeIn();
            setTimeout(() => {
              $('#success circle').addClass("anim");
              $('#success polyline').addClass("anim");
            }, 300);
            break;

          case 409:
            $('#exists').delay(200).fadeIn();
            setTimeout(() => {
              $('#exists circle').addClass("anim");
              $('#exists polyline').addClass("anim");
              $('#exists path').addClass("anim");
            }, 300);

            setTimeout(() => {
              $('#exists svg').addClass("try-again");

              $(".try-again").click(function() {
                $('#exists').fadeOut(200);
                $('#exists circle').removeClass("anim");
                $('#exists polyline').removeClass("anim");
                $('#exists path').removeClass("anim");
                $('#exists svg').removeClass("try-again");

                setTimeout(() => {
                  $('form').fadeIn();
                  $("#heading").fadeIn();
                }, 200);
              });
            }, 2000);
            break;
            
          case 406:
            $('#invalid').delay(200).fadeIn();
            setTimeout(() => {
              $('#invalid circle').addClass("anim");
              $('#invalid line').addClass("anim");
            }, 300);
            break;

          default:
            $('#error').delay(200).fadeIn();
            setTimeout(() => {
              $('#error circle').addClass("anim");
              $('#error polyline').addClass("anim");
            }, 300);
        }
      });
    });
  </script>

</body>
</html>